See comments in the individual source code snippets for info.
