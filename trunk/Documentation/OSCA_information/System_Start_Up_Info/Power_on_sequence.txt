
Normal power On activity
------------------------

(Applies to all V6Z80P configurations)

0. Power switched on.

1. Z80 CPU is held reset (by FPGA "done" line)

2. PIC checks JTAG-mode jumper J2 (only)

  * If jumper J2 is installed, the yellow LED flashes rapidly until the FPGA has 
    been manually configured by downloading a .bit file from Xilinx impact software
    on PC.

  * If jumper J2 is not installed, the PIC sends the config data stored in
    the current active slot of the EEPROM to the FPGA. (The active slot address can
    be changed via software - by default the source address is $20000, IE: Slot 1)

3. If the FPGA starts up correctly with the architecture file supplied (ie: the
   FPGA "Done" line goes high) the yellow LED stays on. If the config fails, the
   yellow LED will pulse and the PIC goes back to step 2.


(The following is OSCA specific)


4. The Z80 is released from reset and runs the ROM code which is held internally
   in the FPGA (mapped into $0-$1ff). This short bootstrap ROM sends a request for
   a "Bootcode" file to the PIC. 

5. The bootcode data (from EEPROM address $F000) is loaded to Z80 address $200-$FBF).
   If the bootcode CRC check is valid, the bootcode executes; Keyboard resets, welcome
   text appears etc. If no bootcode is received, or the CRC word (at offset $DBE)
   is invalid then the display flashes: magenta=CRC error, yellow=timed out. At this point,
   EEPROM location $1F000 will be checked for a backup copy of the bootcode. If this
   also fails (and the version of OSCA is v661+) the screen turns grey - at this point
   a bootcode file can be sent to the V6Z80P serially. (Serial download of the bootcode
   can also be forced by holding up, right and fire on a joystick in port A at power on).

6. Following on, the bootcode looks for an operating system (.OSF file) on the root dir of
   the SD card. If one is not found, EEPROM memory $00800-$047FF is checked for an OS
   signature. (If at this time the ESC key is pressed, the bootcode prompts for OS code
   to be serially downloaded instead). If keys F1-F7 are pressed, the FPGA reconfigures
   from the relevant EEPROM slot. If an OS file is found, it is loaded to $1000, the
   checksum is tested and if OK, code executes from $1010.

7. If no OS is found then the bootcode requests a serial download. Files downloaded
   at boot time are loaded to $1000 with the code execution start address being $1010.
  