
IMPORTANT:
----------

Please make sure you have the latest version of the bootcode installed before
updating OSCA.


Updating OSCA
-------------


1. Optional: Copy the FPGA config *.bin file to the SD card.

2. Boot into FLOS.

3. Load the EEPROM tool (eeprom.exe)

    If EEPROM.EXE is not on your SD card:
    Enter RX * 5000
    Send EEPROM.EXE from the utils folder with the PC serial link app
    Enter G 5000

4. Choose Option 1 "Write config to slot".

5. Choose an inactive slot.

6. Send the FPGA configuration .BIN file with the Serial Link app
   (or enter filename to load from disk if it has been saved there)

7. Wait for file to download, write to EEPROM and complete verification.

8. Choose Option 2 - "Reconfigure from a slot now" (Non-permanent)

9. When prompted, choose to reconfigure from whichever slot you
   used in step 5

10. The FPGA restarts with the new FPGA firmware. This selection
    persists until power off (or changed again with this util)

11. If everything is OK, you can reload the EEPROM tool and choose option 3
    to make the new slot active.


   If you want, you can just rewrite the active slot in the first place, but
   the method above allows you to test the new config before making it default.
   IE: If you overwrite the current Active Slot with a bad config, the FPGA will
   not start at power on and you'll be forced to use one of the emergency options
   to correct it (see below).

   It is recommended that a known-working OSCA config is always present in one
   of the first three slots.


Emergency recovery options:
---------------------------
 
There are 3 different ways to overcome a bad configuration selection
(IE: when the system does not boot.)


 1. With the newer PIC firmware versions, it is possible to change the Active
    Slot manually - of course, for this to be useful you must actually have a
    working configurarion file in one of the slots.
      
    Manual Slot Selection:
    ----------------------

      * Power off.
      * Install jumper J2 only
      * Power on (yellow led flashes rapidly). 
      * Remove jumper J2 again
      * The PIC will reset the active slot to 1 (indicated by 1 pulse of the red LED)
        The yellow led lights up for 4 seconds
        Afterwards, Slot 2 is set (2 flashes of red LED)
        Again there's a 4 second pause, finally slot 3 is set (3 flashes).
      * Power off as soon as the yellow LED comes on following the desired slot setting.
      * When you next power on, the new active slot will be utilized.
 
   
 2. Remove and reprogram the EEPROM or config PIC externally. (Note: The
    PIC holds the slot selection so reprogramming it will reset the active
    slot to SLOT 1). If you reprogram the EEPROM, you'll need to
    preserve $0-$1FFFF as this holds the bootcode (and OS, but that can be
    reinstalled later). It is probably best to erase the entire EEPROM and
    reprogram it with the default binary supplied in the development folder.
  
 
 3. Use the JTAG cable, install J1 and J2 and send the OSCA config from the
    Xilinx webpack software. As long as the bootcode is intact in the EEPROM,
    the system will start and you can then download FLOS and use the EEPROM.EXE
    program.

-------------------------------------------------------------------------------

Notes:

If the version of EEPROM.EXE you have is not compatible with your current
FLOS or OSCA set up, update the firmware in FLOS with the command:

FIRMWARE default.bin 0

using the default.bin file from the EEPROM folder
---------------------------------------------------------------------------------